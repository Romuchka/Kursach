<Window x:Class="SecurityCompanyWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Охранная компания - Управление" 
        Height="850" 
        Width="1200"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="#007ACC" Padding="15">
            <TextBlock Text="ОХРАННАЯ КОМПАНИЯ - СИСТЕМА УПРАВЛЕНИЯ" 
                       FontSize="18" 
                       FontWeight="Bold" 
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>

        <!-- Панель управления -->
        <Border Grid.Row="1" Background="#F5F5F5" Padding="10">
            <StackPanel Orientation="Horizontal">
                <Button Content="Добавить сотрудника" 
                        Click="AddEmployeeButton_Click"
                        Margin="5"/>
                <Button Content="Добавить клиента" 
                        Click="AddClientButton_Click"
                        Margin="5"/>
                <Button Content="Добавить расписание" 
                        Click="AddScheduleButton_Click"
                        Margin="5"/>
                <Button Content="Добавить событие" 
                        Click="AddEventButton_Click"
                        Margin="5"/>
                <TextBlock Text="Поиск:" 
                           Margin="10,0,5,0"
                           VerticalAlignment="Center"/>
                <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                         Width="150"
                         Margin="5"/>
                <Button Content="Сохранить все" 
                        Click="SaveDataButton_Click"
                        Margin="5"
                        Background="#28a745"/>
            </StackPanel>
        </Border>

        <!-- Основной контент -->
        <TabControl Grid.Row="2" Margin="5">

            <!-- Вкладка сотрудников -->
            <TabItem Header="СОТРУДНИКИ">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Таблица сотрудников -->
                    <DataGrid Grid.Row="0" 
                              ItemsSource="{Binding FilteredEmployees}" 
                              SelectedItem="{Binding SelectedEmployee}"
                              AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Фамилия" Binding="{Binding LastName}" Width="100"/>
                            <DataGridTextColumn Header="Имя" Binding="{Binding FirstName}" Width="100"/>
                            <DataGridTextColumn Header="Должность" Binding="{Binding Position}" Width="120"/>
                            <DataGridTextColumn Header="Зарплата" Binding="{Binding CalculateSalary, StringFormat='{}{0:C}'}" Width="100"/>
                            <DataGridCheckBoxColumn Header="Оружие" Binding="{Binding HasWeapon}" Width="80"/>
                            <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="120"/>
                            <DataGridTextColumn Header="Сертификат" Binding="{Binding CertificateNumber}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Панель добавления сотрудника -->
                    <Border Grid.Row="1" 
                            x:Name="AddEmployeePanel" 
                            Background="#E6F3FF" 
                            Padding="10" 
                            Margin="5"
                            Visibility="Collapsed">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Фамилия -->
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Фамилия:" Margin="5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="0"
                                     x:Name="EmployeeLastName" 
                                     Text="Иванов"
                                     Margin="5" 
                                     Width="120"
                                     Background="White"/>

                            <!-- Имя -->
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Имя:" Margin="5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="0"
                                     x:Name="EmployeeFirstName" 
                                     Text="Иван"
                                     Margin="5" 
                                     Width="120"
                                     Background="White"/>

                            <!-- Должность -->
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Должность:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="1"
                                     x:Name="EmployeePosition" 
                                     Text="Охранник"
                                     Margin="5,10,5,5" 
                                     Width="120"
                                     Background="White"/>

                            <!-- Зарплата -->
                            <TextBlock Grid.Column="2" Grid.Row="1" Text="Зарплата:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="1"
                                     x:Name="EmployeeSalary" 
                                     Text="40000"
                                     Margin="5,10,5,5" 
                                     Width="120"
                                     Background="White"/>

                            <!-- Оружие -->
                            <CheckBox Grid.Column="0" Grid.Row="2"
                                      x:Name="EmployeeHasWeapon" 
                                      Content="Имеет оружие"
                                      IsChecked="True"
                                      Margin="5,10,5,5"
                                      VerticalAlignment="Center"/>

                            <!-- Кнопки -->
                            <StackPanel Grid.Column="4" 
                                        Grid.RowSpan="2"
                                        Orientation="Horizontal" 
                                        VerticalAlignment="Center">
                                <Button Content="Сохранить" 
                                        Click="SaveEmployeeButton_Click"
                                        Background="#28a745"
                                        Margin="5"/>
                                <Button Content="Отмена" 
                                        Click="CancelEmployeeButton_Click"
                                        Background="#6c757d"
                                        Margin="5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Вкладка клиентов -->
            <TabItem Header="КЛИЕНТЫ">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Таблица клиентов -->
                    <DataGrid Grid.Row="0" 
                              ItemsSource="{Binding FilteredClients}" 
                              SelectedItem="{Binding SelectedClient}"
                              AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Тип" Binding="{Binding ClientType}" Width="100"/>
                            <DataGridTextColumn Header="Название/ФИО" Binding="{Binding DisplayName}" Width="200"/>
                            <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="200"/>
                            <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="120"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Панель добавления клиента -->
                    <Border Grid.Row="1" 
                            x:Name="AddClientPanel" 
                            Background="#E6F3FF" 
                            Padding="10" 
                            Margin="5"
                            Visibility="Collapsed">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Тип клиента -->
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Тип:" Margin="5" VerticalAlignment="Center"/>
                            <ComboBox Grid.Column="1" Grid.Row="0"
                                      x:Name="ClientTypeComboBox" 
                                      SelectedIndex="0"
                                      Margin="5" 
                                      Width="150">
                                <ComboBoxItem Content="Физическое лицо"/>
                                <ComboBoxItem Content="Юридическое лицо"/>
                            </ComboBox>

                            <!-- Название/ФИО -->
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Название/ФИО:" Margin="5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="0"
                                     x:Name="ClientName" 
                                     Text="ООО Ромашка"
                                     Margin="5" 
                                     Width="200"
                                     Background="White"/>

                            <!-- Адрес -->
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Адрес:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="1"
                                     x:Name="ClientAddress" 
                                     Text="Москва, ул. Ленина, 1"
                                     Margin="5,10,5,5" 
                                     Width="200"
                                     Grid.ColumnSpan="3"
                                     Background="White"/>

                            <!-- Кнопки -->
                            <StackPanel Grid.Column="4" 
                                        Grid.RowSpan="2"
                                        Orientation="Horizontal" 
                                        VerticalAlignment="Center">
                                <Button Content="Сохранить" 
                                        Click="SaveClientButton_Click"
                                        Background="#28a745"
                                        Margin="5"/>
                                <Button Content="Отмена" 
                                        Click="CancelClientButton_Click"
                                        Background="#6c757d"
                                        Margin="5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Вкладка расписания -->
            <TabItem Header="РАСПИСАНИЕ">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Таблица расписания -->
                    <DataGrid Grid.Row="0" 
                              ItemsSource="{Binding DutySchedules}"
                              SelectedItem="{Binding SelectedDutySchedule}"
                              AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Сотрудник" Binding="{Binding Employee.FullName}" Width="200"/>
                            <DataGridTextColumn Header="Дата" Binding="{Binding DutyDate, StringFormat='dd.MM.yyyy'}" Width="100"/>
                            <DataGridTextColumn Header="Начало" Binding="{Binding StartTime, StringFormat='hh\\:mm'}" Width="80"/>
                            <DataGridTextColumn Header="Конец" Binding="{Binding EndTime, StringFormat='hh\\:mm'}" Width="80"/>
                            <DataGridTextColumn Header="Замена" Binding="{Binding ReplacementEmployee.FullName}" Width="150"/>
                            <DataGridTextColumn Header="Причина замены" Binding="{Binding ReplacementReason}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Панель добавления расписания -->
                    <Border Grid.Row="1" 
                            x:Name="AddSchedulePanel" 
                            Background="#E6F3FF" 
                            Padding="10" 
                            Margin="5"
                            Visibility="Collapsed">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Выбор сотрудника -->
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Сотрудник:" Margin="5" VerticalAlignment="Center"/>
                            <ComboBox Grid.Column="1" Grid.Row="0"
                                      x:Name="ScheduleEmployeeComboBox"
                                      DisplayMemberPath="FullName"
                                      Margin="5" 
                                      Width="200"/>

                            <!-- Дата -->
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Дата:" Margin="5" VerticalAlignment="Center"/>
                            <DatePicker Grid.Column="3" Grid.Row="0"
                                        x:Name="ScheduleDatePicker"
                                        SelectedDate="{x:Static sys:DateTime.Today}"
                                        Margin="5" 
                                        Width="120"/>

                            <!-- Время начала -->
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Начало (чч:мм):" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="1"
                                     x:Name="ScheduleStartTime"
                                     Text="08:00"
                                     Margin="5,10,5,5" 
                                     Width="100"
                                     Background="White"/>

                            <!-- Время окончания -->
                            <TextBlock Grid.Column="2" Grid.Row="1" Text="Конец (чч:мм):" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="1"
                                     x:Name="ScheduleEndTime"
                                     Text="20:00"
                                     Margin="5,10,5,5" 
                                     Width="100"
                                     Background="White"/>

                            <!-- Причина замены -->
                            <TextBlock Grid.Column="0" Grid.Row="2" Text="Причина замены:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="2"
                                     x:Name="ScheduleReason"
                                     Text=""
                                     Margin="5,10,5,5" 
                                     Width="200"
                                     Grid.ColumnSpan="3"
                                     Background="White"/>

                            <!-- Кнопки -->
                            <StackPanel Grid.Column="4" 
                                        Grid.RowSpan="3"
                                        Orientation="Horizontal" 
                                        VerticalAlignment="Center">
                                <Button Content="Сохранить" 
                                        Click="SaveScheduleButton_Click"
                                        Background="#28a745"
                                        Margin="5"/>
                                <Button Content="Отмена" 
                                        Click="CancelScheduleButton_Click"
                                        Background="#6c757d"
                                        Margin="5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Вкладка событий -->
            <TabItem Header="СОБЫТИЯ">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Таблица событий -->
                    <DataGrid Grid.Row="0" 
                              ItemsSource="{Binding Events}"
                              SelectedItem="{Binding SelectedEvent}"
                              AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Название" Binding="{Binding EventName}" Width="200"/>
                            <DataGridTextColumn Header="Дата" Binding="{Binding EventDate, StringFormat='dd.MM.yyyy'}" Width="100"/>
                            <DataGridTextColumn Header="Начало" Binding="{Binding StartTime, StringFormat='hh\\:mm'}" Width="80"/>
                            <DataGridTextColumn Header="Конец" Binding="{Binding EndTime, StringFormat='hh\\:mm'}" Width="80"/>
                            <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="200"/>
                            <DataGridTextColumn Header="Участников" Binding="{Binding ParticipantsCount}" Width="80"/>
                            <DataGridTextColumn Header="Охранников" Binding="{Binding RequiredGuardsCount}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Панель добавления события -->
                    <Border Grid.Row="1" 
                            x:Name="AddEventPanel" 
                            Background="#E6F3FF" 
                            Padding="10" 
                            Margin="5"
                            Visibility="Collapsed">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Название события -->
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Название:" Margin="5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="0"
                                     x:Name="EventNameTextBox"
                                     Text="Корпоративное мероприятие"
                                     Margin="5" 
                                     Width="200"
                                     Background="White"/>

                            <!-- Дата события -->
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Дата:" Margin="5" VerticalAlignment="Center"/>
                            <DatePicker Grid.Column="3" Grid.Row="0"
                                        x:Name="EventDatePicker"
                                        SelectedDate="{x:Static sys:DateTime.Today}"
                                        Margin="5" 
                                        Width="120"/>

                            <!-- Время начала -->
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Начало (чч:мм):" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="1"
                                     x:Name="EventStartTime"
                                     Text="18:00"
                                     Margin="5,10,5,5" 
                                     Width="100"
                                     Background="White"/>

                            <!-- Время окончания -->
                            <TextBlock Grid.Column="2" Grid.Row="1" Text="Конец (чч:мм):" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="1"
                                     x:Name="EventEndTime"
                                     Text="23:00"
                                     Margin="5,10,5,5" 
                                     Width="100"
                                     Background="White"/>

                            <!-- Адрес -->
                            <TextBlock Grid.Column="0" Grid.Row="2" Text="Адрес:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="2"
                                     x:Name="EventAddress"
                                     Text="Москва, ул. Тверская, 10"
                                     Margin="5,10,5,5" 
                                     Width="200"
                                     Grid.ColumnSpan="3"
                                     Background="White"/>

                            <!-- Количество участников -->
                            <TextBlock Grid.Column="0" Grid.Row="3" Text="Участников:" Margin="5,10,5,5" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="3"
                                     x:Name="EventParticipants"
                                     Text="100"
                                     Margin="5,10,5,5" 
                                     Width="100"
                                     Background="White"/>

                            <!-- Кнопки -->
                            <StackPanel Grid.Column="4" 
                                        Grid.RowSpan="4"
                                        Orientation="Horizontal" 
                                        VerticalAlignment="Center">
                                <Button Content="Сохранить" 
                                        Click="SaveEventButton_Click"
                                        Background="#28a745"
                                        Margin="5"/>
                                <Button Content="Отмена" 
                                        Click="CancelEventButton_Click"
                                        Background="#6c757d"
                                        Margin="5"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

        </TabControl>

        <!-- Статусная строка -->
        <Border Grid.Row="3" Background="#007ACC" Padding="10">
            <TextBlock x:Name="StatusText" 
                       Text="{Binding StatusMessage}" 
                       Foreground="White"/>
        </Border>

    </Grid>
</Window>